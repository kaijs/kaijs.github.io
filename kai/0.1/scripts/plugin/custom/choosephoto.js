define("plugin/custom/choosephoto",["./MegaPixImage","cutil/c.util.common"],function(e,t){var i=0,a={choosePhotoHelper:{renderHtml:function(a,n,l,s){var o,d,c,r,s=s||{},h=h||window.webkitURL,y=document.createElement("canvas"),m=y.getContext("2d"),p=new Image,c=n,r=l||null,g=document.createElement("div"),u=document.createElement("div"),f=document.createElement("span");f.classList.add("ext_file_img"),f.innerHTML="&nbsp; ",d=document.createElement("input"),d.type="file",d.accept="image/*",d.id="img_txt",s.capture&&$(d).attr("capture",s.capture||""),g.id="img_upload_div",g.classList.add("no_iscroll"),g.style.position="absolute",g.style["z-index"]="10",g.style.height="100%",g.style.top="0",g.style.width="100%",g.style.height="25",g.style.margin="0",u.style.position="relative",u.style["font-weight"]="300",u.style["font-size"]="12px",u.style.overflow="hidden",u.style.display="inline-block",u.style["text-decoration"]="none",u.style.border="0 none",u.style["vertical-align"]="middle",u.style.cursor="pointer",u.style.color="#099fde",u.style.width="100%",u.style.height="100%",u.style.color="#099fde",u.style.width="100%",u.style.display="inline-block",u.className="nofastclick js_img_div",f.style.display="block",f.style["-webkit-animation"]="all 800ms ease-in-out,opacity 500ms ease-in-out",f.style["-moz-animation"]="all 800ms ease-in-out,opacity 500ms ease-in-out",f.style["-ms-animation"]="all 800ms ease-in-out,opacity 500ms ease-in-out",f.style.animation="all 800ms ease-in-out,opacity 500ms ease-in-out",f.style.width="100%",f.style.height="30px",f.style["float"]="left",f.style["font-size"]="15px",d.readOnly="readOnly",d.style.opacity="0",d.style.position="absolute",d.style.left="0",d.style["font-size"]="40px",d.style.width="100%",d.style.height="100%",d.style.direction="rtl",d.className="nofastclick",u.appendChild(f),u.appendChild(d),g.appendChild(u),"function"==typeof $(a).append&&$(a).append(g),p.onload=function(){h.revokeObjectURL(p.src);var i=.8,a=768;if(p.width>a){var n=1-(p.width-a)/p.width;p.width=p.width*n,p.height=p.height*n}y.height=p.height,y.width=p.width,m.drawImage(p,0,0,y.width,y.height);var l;if(navigator.userAgent.match(/iphone/i)){var s=new e(p);s.render(y,{maxWidth:p.width,maxHeight:p.height,quality:i}),l=y.toDataURL("image/jpeg",i)}else if(navigator.userAgent.match(/Android/i)){var o=new t.JPEGEncoder;l=o.encode(m.getImageData(0,0,p.width,p.height),80)}else l=y.toDataURL("image/jpeg",i);$(c).html('<img  style="-webkit-transform: translate(0px, 0px) translateZ(0px);" class="share_contentimg no_inputclear" alt="" src="'+l+'">'),_.isFunction(r)&&r&&r()},d.onchange=function(){if(d.files[0]&&d.value)if(h){Kai.showLoading();try{var e;_.delay(function(){e=h.createObjectURL(d.files[0]);var t=2e3;if(i){var a=i-new Date;t=a>0?t+a:t}o=_.delay(function(){p.src=e,Kai.hideLoading()},t),i=+new Date+t},2e3)}catch(t){}}else;}}}};return a});